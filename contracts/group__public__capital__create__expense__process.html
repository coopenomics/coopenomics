<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="COOPENOMICS" />
<meta property="og:image" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta property="og:description" content="Документация на смарт-контракты платформы Кооперативной Экономики на языке C/C++" />
<meta property="og:url" content="https://jothepro.github.io/doxygen-awesome-css/" />
<!-- END opengraph metadata -->
<!-- BEGIN twitter metadata -->
<meta name="twitter:image:src" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta name="twitter:title" content="COOPENOMICS" />
<meta name="twitter:description" content="Документация на смарт-контракты платформы Кооперативной Экономики на языке C/C++" />
<!-- END twitter metadata -->
<title>COOPENOMICS: Списание расходов</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="mermaid.min.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    if (window.mermaid) {
      try {
        // Initialize mermaid with auto theme based on current dark mode state
        const isDarkMode = document.documentElement.classList.contains('dark-mode');
        const theme = isDarkMode ? 'dark' : 'neutral';
        mermaid.initialize({
          startOnLoad: true,
          theme: theme,
          securityLevel: 'loose',
          fontFamily: 'arial',
          fontSize: 14
        });
        console.log('success mermaid init with theme:', theme);
      } catch (error) {
        console.warn('Mermaid initialization error:', error);
      }
    }
  });
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/coopenomics" class="github-corner" title="Смотреть исходники на GitHub">
    <svg viewBox="0 0 250 250" style="position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">COOPENOMICS
   &#160;<span id="projectnumber">v1</span>
   </div>
   <div id="projectbrief">Кооперативная Экономика</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Создано системой Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Поиск','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Поиск');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__public__capital__create__expense__process.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Списание расходов<div class="ingroups"><a class="el" href="group__public__capital.html">Контракт CAPITAL</a> &raquo; <a class="el" href="group__public__capital__processes.html">Процессы</a></div></div></div>
</div><!--header-->
<div class="contents">
<p >Процесс создания, одобрения, авторизации и оплаты операционных расходов проекта из накопленного пула расходов представляет собой формализованную процедуру, которая позволяет вкладчикам проекта запрашивать расходы на операционные нужды проекта. Процесс включает подачу заявления вкладчиком, проверку достаточности накопленных средств в пуле расходов, резервирование запрашиваемой суммы, одобрение председателем и авторизацию советом кооператива. После авторизации происходит перевод средств через платёжный шлюз для оплаты расходов проекта.</p>
<h2><a class="anchor" id="autotoc_md65"></a>
Диаграмма процесса</h2>
<p > 
<div class="mermaid">
sequenceDiagram
    participant P as Вкладчик
    participant C as Capital Contract
    participant S as Soviet Contract
    participant G as Gateway Contract

    P->>C: 1. Подача заявления о расходе
    Note over C: Проверка участия в проекте
    Note over C: Резервирование средств из пула

    C->>S: 2. Запрос предварительного одобрения
    S->>C: 3. Направление на рассмотрение совета

    alt Авторизация
        S->>C: 4. Авторизация советом
        C->>G: 5. Создание исходящего платежа
        G->>C: 6. Подтверждение выполнения платежа
        Note over C: Обновление используемых средств
    else Отклонение
        S->>C: 4. Отклонение советом
        Note over C: Возврат средств в пул
    end
</div>
</p>
<h2><a class="anchor" id="autotoc_md66"></a>
Подача заявления о расходе</h2>
<p >Вкладчик проекта подает заявление о необходимости расхода с указанием суммы расхода, описания назначения и обоснования в заявлении. Система проверяет подлинность заявления и корректность данных.</p>
<h2><a class="anchor" id="autotoc_md67"></a>
Проверка участия в проекте</h2>
<p >Система проверяет наличие активного договора УХД вкладчика в проекте. Только активные вкладчики с подписанными приложениями могут создавать расходы.</p>
<h2><a class="anchor" id="autotoc_md68"></a>
Проверка уникальности расхода</h2>
<p >Проверяется уникальность расхода по предоставленному хешу. Это предотвращает дублирование расходов и обеспечивает целостность учета.</p>
<h2><a class="anchor" id="autotoc_md69"></a>
Проверка доступности средств</h2>
<p >Система проверяет достаточность накопленных средств в пуле расходов для покрытия расхода, корректность суммы (положительное значение) и соответствие валюты проекта.</p>
<h2><a class="anchor" id="autotoc_md70"></a>
Резервирование средств</h2>
<p >Система резервирует запрошенную сумму, уменьшая накопленные средства пула на размер расхода. Это предотвращает повторное использование средств.</p>
<h2><a class="anchor" id="autotoc_md71"></a>
Создание записи расхода</h2>
<p >Создается запись расхода в таблице с указанием всех параметров, включая хеш расхода для идентификации, сумму, описание и связанное заявление.</p>
<h2><a class="anchor" id="autotoc_md72"></a>
Одобрение и авторизация расхода</h2>
<p ><a class="el" href="group__public__capital__actions.html#gaaeab2531035884c1f0198ad1deee177a">Одобрение расхода</a> <a class="el" href="group__public__capital__actions.html#ga56acab45f37bb8bde59603cd66d65ba3">Авторизация расхода советом</a></p>
<p >Председатель одобряет расход и направляет на рассмотрение совета. Совет авторизует расход и создаёт исходящий платёж через платёжный шлюз.</p>
<h2><a class="anchor" id="autotoc_md73"></a>
Подтверждение оплаты расхода</h2>
<p ><a class="el" href="group__public__capital__actions.html#ga9eaa4019848cfdb62530349fd282219d">Подтверждение оплаты расхода</a></p>
<p >Платёжный шлюз подтверждает факт совершения исходящего платежа. Обновляется сумма использованных средств проекта и запись расхода удаляется.</p>
<h2><a class="anchor" id="autotoc_md74"></a>
Создание заявления о расходе</h2>
<p ><a class="el" href="group__public__capital__actions.html#gacf3a843bbf35be64fceccc1191fcdcf5">Создание расхода</a></p>
<p >Вкладчик проекта подаёт заявление о необходимости операционного расхода:</p>
<dl class="section pre"><dt>Предусловие</dt><dd><b>Входящий документ:</b> Заявление о необходимости операционного расхода проекта </dd>
<dd>
<b>Предварительные условия:</b><ul>
<li>Вкладчик имеет активный договор УХД в проекте</li>
<li>Накопленные средства пула расходов достаточны для покрытия расхода</li>
<li>Сумма расхода положительная</li>
</ul>
</dd></dl>
<p><b>Механика создания расхода:</b></p><ul>
<li>Выполняется проверка уникальности расхода по хешу</li>
<li>Проверяется доступность средств в пуле расходов</li>
<li>Сумма резервируется из накопленных средств пула</li>
</ul>
<p ><b>Результат:</b> Заявление создано, средства зарезервированы для расхода. После авторизации совета происходит оплата расхода через платёжный шлюз.</p>
<dl class="section post"><dt>Постусловие</dt><dd>Заявление о расходе создано и проверено </dd>
<dd>
Средства зарезервированы из накопленного пула расходов</dd></dl>
<h2><a class="anchor" id="autotoc_md75"></a>
Одобрение и авторизация расхода</h2>
<p >После создания заявления председатель одобряет расход и направляет его на рассмотрение советом. Совет принимает решение об авторизации расхода:</p>
<dl class="section post"><dt>Постусловие</dt><dd>Расход направлен на рассмотрение советом </dd>
<dd>
Создан исходящий платёж через платёжный шлюз</dd></dl>
<h2><a class="anchor" id="autotoc_md76"></a>
Отклонение расхода</h2>
<p >При отклонении расхода советом зарезервированная сумма возвращается в пул расходов:</p>
<dl class="section post"><dt>Постусловие</dt><dd>Средства возвращаются в накопленный пул расходов </dd>
<dd>
Запись расхода удаляется из системы</dd></dl>
<h2><a class="anchor" id="autotoc_md77"></a>
Подтверждение выполнения платежа</h2>
<p >После совершения исходящего платежа через платёжный шлюз:</p>
<dl class="section post"><dt>Постусловие</dt><dd>Сумма использованных средств проекта обновлена </dd>
<dd>
Запись расхода удалена из системы</dd></dl>
<h2><a class="anchor" id="autotoc_md78"></a>
Эффекты процесса</h2>
<p >➕🏛️ <a class="el" href="class_ledger.html#ab49534dd0e92c5ba0cd31a1d22265506" title="Добавить средства на счёт кооператива">Ledger::add</a> на счёт <a class="el" href="struct_ledger_1_1accounts.html#aba75b5d36f6cea77b1c2e0e8a6993d3f" title="Фонд обеспечения хозяйственной деятельности">Ledger::accounts::ECONOMIC_ACTIVITY_FUND</a> на сумму расхода<br  />
</p>
<h2><a class="anchor" id="autotoc_md79"></a>
Документы процесса</h2>
<p ><ul>
<li>📄 Служебная записка</li>
<li>📄 Протокол решения совета по списанию расходов (?) </li>
</ul>
</p>
<h2><a class="anchor" id="autotoc_md80"></a>
Связанные процессы</h2>
<ul>
<li><a class="el" href="group__public__capital__fundproj__process.html">Регистрация членских взносов в проект</a></li>
<li><a class="el" href="group__public__capital__refresh__project__process.html">Обновление кошелька проекта</a> </li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Создано системой <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
<script type="text/javascript">
  $(function() {
     toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
     toggleButton.title = "Toggle Light/Dark Mode"
     $(document).ready(function(){
       document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
     })
     $(window).resize(function(){
       document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
     })
   })
</script>
</body>
</html>
