<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<!-- BEGIN opengraph metadata -->
<meta property="og:title" content="COOPENOMICS" />
<meta property="og:image" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta property="og:description" content="Документация на смарт-контракты платформы Кооперативной Экономики на языке C/C++" />
<meta property="og:url" content="https://jothepro.github.io/doxygen-awesome-css/" />
<!-- END opengraph metadata -->
<!-- BEGIN twitter metadata -->
<meta name="twitter:image:src" content="https://repository-images.githubusercontent.com/348492097/4f16df80-88fb-11eb-9d31-4015ff22c452" />
<meta name="twitter:title" content="COOPENOMICS" />
<meta name="twitter:description" content="Документация на смарт-контракты платформы Кооперативной Экономики на языке C/C++" />
<!-- END twitter metadata -->
<title>COOPENOMICS: Конвертация взноса результатом</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link rel="icon" type="image/svg+xml" href="logo.drawio.svg"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript" src="mermaid.min.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    if (window.mermaid) {
      try {
        // Initialize mermaid with auto theme based on current dark mode state
        const isDarkMode = document.documentElement.classList.contains('dark-mode');
        const theme = isDarkMode ? 'dark' : 'neutral';
        mermaid.initialize({
          startOnLoad: true,
          theme: theme,
          securityLevel: 'loose',
          fontFamily: 'arial',
          fontSize: 14
        });
        console.log('success mermaid init with theme:', theme);
      } catch (error) {
        console.warn('Mermaid initialization error:', error);
      }
    }
  });
</script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- https://tholman.com/github-corners/ -->
<a href="https://github.com/coopenomics" class="github-corner" title="Смотреть исходники на GitHub">
    <svg viewBox="0 0 250 250" style="position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true">
    <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">COOPENOMICS
   &#160;<span id="projectnumber">v1</span>
   </div>
   <div id="projectbrief">Кооперативная Экономика</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Создано системой Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Поиск','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Поиск');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('group__public__capital__conversion__process.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle"><div class="title">Конвертация взноса результатом<div class="ingroups"><a class="el" href="group__public__capital.html">Контракт CAPITAL</a> &raquo; <a class="el" href="group__public__capital__processes.html">Процессы</a></div></div></div>
</div><!--header-->
<div class="contents">
<dl class="section pre"><dt>Предусловие</dt><dd>Результат интеллектуальной деятельности внесен в кооператив </dd>
<dd>
Выданная ссуда погашена </dd>
<dd>
Статус сегмента CONTRIBUTED </dd>
<dd>
Долг уменьшает доступные для конвертации в кошелек суммы создателя/автора/координатора</dd></dl>
<p>После внесения результата в кооператив - баланс пользователя должен быть сконвертирован в одно из трех направлений: в главный кошелёк для немедленного использования в других программах или для возврата на банковский счёт, в кошелёк программы "Капитализация" для долгосрочного участия или в кошелёк проекта для получения возврата паевого взноса из числа членских взносов этого проекта.</p>
<dl class="section note"><dt>Заметки</dt><dd>Ограничения по направлениям конвертации:<ul>
<li>В главный кошелёк: только себестоимость создателей, авторов и координаторов минус погашенный долг, не больше обеспеченной суммы</li>
<li>В кошелёк проекта: только себестоимость всех ролей (создатели, авторы, координаторы, инвесторы, пропертор)</li>
<li>В кошелёк программы: все взносы минус погашенный долг минус суммы, направленные в проект и кошелек</li>
</ul>
</dd></dl>
<p> 
 <div class="mermaid">
 sequenceDiagram
     participant В as Вкладчик
     participant C as Capital Contract
     participant W as Wallet Contract
     
     В->>C: Конвертация сегмента
     Note over C: Проверка статуса CONTRIBUTED
     Note over C: Проверка погашения долга
     Note over C: Валидация ограничений по суммам
     Note over C: Проверка разрешения can_convert_to_project
     
     alt В главный кошелёкёк
         C->>W: Разблокировка из программного кошелька
         C->>W: Зачисление в доступные средства
         Note over W: Средства доступны для вывода
     end
     
     alt В программу Капитализация
         C->>W: Разблокировка из программного кошелька
         C->>W: Блокировка в программе капитализации
         Note over W: Получение доли в CRPS программы
     end
     
     alt В кошелёк проекта
         C->>C: Создание/обновление кошелька проекта
         C->>C: Увеличение долей в проекте
         Note over C: Право на членские взносы проекта
     end
     
     Note over C: Статус сегмента изменяется на COMPLETED
 </div>
 </p>
<h2><a class="anchor" id="autotoc_md243"></a>
Пошаговое описание процесса</h2>
<h3><a class="anchor" id="autotoc_md244"></a>
Шаг 1: Конвертация сегмента</h3>
<p ><b>Действие:</b> <a class="el" href="group__public__capital__actions.html#ga29c7a61482ce25e80e08327b972d67f6">конвертация сегмента участника</a></p>
<p >Вкладчик распределяет свои доступные средства между тремя направлениями согласно выбранной стратегии. Система проверяет соблюдение всех ограничений:</p><ul>
<li>Долг должен быть погашен (debt_settled &gt;= debt_amount)</li>
<li>Общая сумма конвертации равна всем взносам участника минус погашенный долг</li>
<li>В главный кошелёкёк: только себестоимость создателей, авторов и координаторов минус погашенный долг, не больше обеспеченной суммы</li>
<li>В кошелёк проекта: только себестоимость всех ролей (создатели, авторы, координаторы, инвесторы, пропертор)</li>
<li>В капитализацию: все взносы минус погашенный долг минус конвертированные в проект и кошелек</li>
<li><p class="startli">Проект разрешает конвертацию в свой кошелёк</p>
<dl class="section post"><dt>Постусловие</dt><dd>разблокируются средства из программного кошелька </dd>
<dd>
часть средств зачисляется в доступные для вывода </dd>
<dd>
часть средств блокируется в программе капитализации </dd>
<dd>
часть средств направляется в кошелёк проекта </dd>
<dd>
статус сегмента изменяется на COMPLETED </dd>
<dd>
увеличиваются доли участника в выбранных направлениях</dd></dl>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md245"></a>
Направления конвертации</h2>
<p ><b>главный кошелёкёк</b> - средства становятся доступными для немедленного возврата и использования. Конвертировать можно только себестоимость создателей, авторов и координаторов минус погашенный долг, но не больше обеспеченной суммы.</p>
<p ><b>Программа Капитализация</b> - средства блокируются для участия в долгосрочной программе накопления с выгодной от членских взносов. Конвертируются все взносы минус погашенный долг минус те, что направлены в проект и кошелек. Общая сумма конвертации должна равняться всем взносам участника минус погашенный долг.</p>
<p ><b>Кошелёк проекта</b> - средства остаются в проекте для получения членских взносов конкретно от данного проекта. Конвертировать можно только себестоимость всех ролей (создатели, авторы, координаторы, инвесторы, пропертор). Требует разрешения проекта на конвертацию. При наличии родительского проекта конвертация будет происходить в его кошелёк.</p>
<h2><a class="anchor" id="autotoc_md246"></a>
Эффекты процесса</h2>
<p >➖🔒 <a class="el" href="class_wallet.html#ae1679f268ed4f71409a9024166b29f2b" title="Уменьшает заблокированные средства кошелька пользователя">Wallet::sub_blocked_funds</a> на кошельке <a class="el" href="consts_8hpp.html#a7230ac26306849d2edfa46e4feab091a">_source_program</a> на сумму паевого взноса за вычетом суммы конвертации в кошелёк проекта<br  />
➕🔓 <a class="el" href="class_wallet.html#a734c5f53ffb4470db6112c1664be6cbe" title="Добавляет доступные средства на кошелёк пользователя">Wallet::add_available_funds</a> на кошельке <a class="el" href="consts_8hpp.html#a4c69e9dd2bcc07568bc73bcc74772b01">_wallet_program</a> на сумму конвертации в главный кошелёк<br  />
➕🔒 <a class="el" href="class_wallet.html#a52270ac18ff80063d910dec0a29e83f9" title="Добавляет заблокированные средства в баланс кошелька пользователя">Wallet::add_blocked_funds</a> на кошельке <a class="el" href="consts_8hpp.html#a7230ac26306849d2edfa46e4feab091a">_source_program</a> на сумму конвертации в кошелёк программы<br  />
</p>
<h2><a class="anchor" id="autotoc_md247"></a>
Документы процесса</h2>
<p ><ul>
<li>📄 Заявление на конвертацию из кошелька приложения к договору УХД (договора УХД) в:<ul>
<li>главный кошелёк (ЦПП "Цифровой Кошелёк")</li>
<li>кошелёк проекта (другое или то же приложение к договору УХД)</li>
<li>кошелёк программы (ЦПП "Капитализация") </li>
</ul>
</li>
</ul>
</p>
<h2><a class="anchor" id="autotoc_md248"></a>
Ограничения конвертации</h2>
<ul>
<li><b>В главный кошелёкёк:</b> только себестоимость создателей, авторов и координаторов минус погашенный долг, не больше обеспеченной суммы</li>
<li><b>В кошелёк проекта:</b> только себестоимость всех ролей (создатели, авторы, координаторы, инвесторы, пропертор)</li>
<li><b>В капитализацию:</b> все взносы минус погашенный долг минус конвертированные в проект и кошелек</li>
<li><b>Общее требование:</b> сумма всех конвертаций должна равняться всем взносам участника минус погашенный долг</li>
<li><b>Долг:</b> должен быть погашен перед конвертацией (debt_settled &gt;= debt_amount), уменьшает доступные суммы для кошелька</li>
<li>Конвертация в проект требует разрешения проекта</li>
<li>При наличии родительского проекта средства направляются в него </li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Создано системой <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3 </li>
  </ul>
</div>
<script type="text/javascript">
  $(function() {
     toggleButton = document.createElement('doxygen-awesome-dark-mode-toggle')
     toggleButton.title = "Toggle Light/Dark Mode"
     $(document).ready(function(){
       document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
     })
     $(window).resize(function(){
       document.getElementById("MSearchBox").parentNode.appendChild(toggleButton)
     })
   })
</script>
</body>
</html>
